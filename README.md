# Генерация Excel на лету

В рамках решения необходимо реализовать HTTP API для генерации Excel файла на лету. Генерация на лету означает отсутствие временных файлов, все процедуры должны происходить в памяти.

Excel таблица должна содержать колонки:  
Дата;  
Время;  
Случайное число;  
Случайная строка.

Значение для колонок:  
текущая дата по временной зоне UTC;  
текущее время по временной зоне UTC;  
случайное число от 0 до 1000;  
случайная строка от 2 до 12 символов. Строка должна содержать только латинские символы в любом регистре и числа.

Первая строка Excel таблицы должна содержать наименование колонок.

К внешнему виду и форматирования нет ограничений, на усмотрение исполнителя.

Из API файл должен вернуться с mime type Excel таблицы, его имя должно соответствовать шаблону  “file_generated_at_YYYYMMDD.xlsx”, где:  
YYYY - текущий год;  
MM - текущий месяц с ведущим нулем;  
DD - текущий день с ведущим нулем.

Стек технологий:  
FastAPI последней версии;  
xlsxwriter, openpyxl - любой из перечисленных  
стандартная библиотека Python.

Другие сторонние библиотеки запрещены.


## Установка

Зависимости:
- Python 3.8+
- Python development files, python3-dev
- VirtualEnv или venv
- Pip3

Создать виртуальное окружение: `virtualenv -p python3 env`

Активировать окружение: `source env/bin/activate`

Установить зависимоcти: `pip3 install -r requirements/rest_api.txt`

## Сервисы

`excel_onfly.py` - REST API для работы с данными сервиса

# Локальное окружение

Необходимо поставить docker и docker-compose

Для настройки локального сервиса запустите `docker-compose build`

Для старта сервисов `docker-compose up`

Сервисы:
1. API http://localhost:8010
2. Документация на API доступна на http://localhost:8010/docs

# Тесты

Для выполнения тестов запускаем сервис из докера и выполняем:

1. Все тесты `docker-compose run rest_api pytest .` 
2. Конкретный модуль `docker-compose run rest_api pytest tests/services/rest_api/test_file.py` 
3. Конкретный тест из модуля `docker-compose run rest_api pytest tests/services/rest_api/test_file.py::test_generation` 
